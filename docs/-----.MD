## Tarea 3: Unificar y normalizar schemas

### Responsable: 1 desarrollador

### Tiempo estimado: 2 d칤as

### Prioridad: 游리 Media

### Problema actual

- Inconsistencia en nombres de campos (id vs id_eje)
- Validaciones duplicadas
- Falta de validaciones reutilizables
- Schemas incompletos (faltan Patentes, Registros)

### Soluci칩n propuesta

#### Archivos a crear:

1. `src/schemas/common.ts` - Validaciones reutilizables
2. `src/schemas/patentes.ts` - Schema para patentes
3. `src/schemas/registros.ts` - Schema para registros

#### Archivos a modificar:

- Todos los schemas existentes en `src/schemas/*.ts`

#### Implementaci칩n

**1. Validaciones comunes**

```typescript
// src/schemas/common.ts
import { z } from "zod";

export const commonValidations = {
	id: z.number().int().positive("ID inv치lido"),
	email: z.string().email("Email inv치lido").max(255),
	url: z.string().url("URL inv치lida").max(2000),
	shortText: z.string().min(1, "Campo requerido").max(255),
	mediumText: z.string().min(1, "Campo requerido").max(1000),
	longText: z.string().min(1, "Campo requerido").max(10000),
	positiveNumber: z.number().positive("Debe ser positivo"),
	boolean: z.boolean(),
	date: z.string().datetime("Fecha inv치lida"),
};

export const createInsertSchema = <T extends z.ZodRawShape>(shape: T) => z.object(shape);

export const createUpdateSchema = <T extends z.ZodRawShape>(shape: T) => z.object({ id: commonValidations.id, ...shape });

export const createDeleteSchema = () => z.object({ id: commonValidations.id });
```

**2. Refactorizar schemas existentes**

```typescript
// src/schemas/fuentes.ts (refactorizado)
import { z } from "zod";
import { commonValidations, createUpdateSchema, createDeleteSchema } from "./common";

export const InsertFuenteSchema = z.object({
	title: commonValidations.shortText,
	organization: commonValidations.shortText,
	editores: commonValidations.shortText,
	frequency: commonValidations.positiveNumber,
	url: commonValidations.url,
	materia: commonValidations.shortText,
	id_eje: commonValidations.id,
	is_monitoring: commonValidations.boolean,
});

export const UpdateFuenteSchema = createUpdateSchema(InsertFuenteSchema.shape);
export const DeleteFuenteSchema = createDeleteSchema();

export type TSInsertFuenteSchema = z.infer<typeof InsertFuenteSchema>;
export type TSUpdateFuenteSchema = z.infer<typeof UpdateFuenteSchema>;
export type TSDeleteFuenteSchema = z.infer<typeof DeleteFuenteSchema>;
```

### Checklist

- [ ] Crear validaciones comunes reutilizables
- [ ] Refactorizar schemas existentes
- [ ] Crear schemas faltantes (Patentes, Registros)
- [ ] Estandarizar nombres de campos
- [ ] Actualizar tests
- [ ] Documentar convenciones

---
